<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asonik Store</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <!-- Babel to transpile JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, addDoc, doc, deleteDoc, setDoc, serverTimestamp, query, where, orderBy, updateDoc, getDocs, increment, getDoc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";
        
        window.firebase = {
            initializeApp, getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut, updateProfile,
            getFirestore, collection, onSnapshot, addDoc, doc, deleteDoc, setDoc, serverTimestamp, query, where, orderBy, updateDoc, getDocs, increment, getDoc
        };
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; transition: background-color 0.3s, color 0.3s; }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        :root {
            --bg-primary: #111827;
            --bg-secondary: #1f2937;
            --bg-tertiary: #374151;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --accent-primary: #8b5cf6;
            --accent-secondary: #a78bfa;
            --border-color: #374151;
        }
        body.light {
            --bg-primary: #f9fafb;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f3f4f6;
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --border-color: #e5e7eb;
        }
        body.asonik {
            --bg-primary: #4c1d95; /* purple-900 */
            --bg-secondary: #5b21b6; /* purple-800 */
            --bg-tertiary: #6d28d9; /* purple-700 */
            --text-primary: #f5d0fe; /* purple-100 */
            --text-secondary: #e9d5ff; /* purple-200 */
            --accent-primary: #f5d0fe;
            --accent-secondary: #ffffff;
            --border-color: #6b21a8;
        }

        .bg-primary { background-color: var(--bg-primary); }
        .bg-secondary { background-color: var(--bg-secondary); }
        .bg-tertiary { background-color: var(--bg-tertiary); }
        .text-primary { color: var(--text-primary); }
        .text-secondary { color: var(--text-secondary); }
        .border-color { border-color: var(--border-color); }
        .accent-text { color: var(--accent-primary); }
        .accent-bg { background-color: var(--accent-primary); }
        .accent-border { border-color: var(--accent-primary); }
        .hover\:accent-bg:hover { background-color: var(--accent-primary); }
        .hover\:accent-bg-secondary:hover { background-color: var(--accent-secondary); }
        
        .chat-bubble { max-width: 75%; word-wrap: break-word; }
        .chat-bubble-user { background-color: #4f46e5; }
        .chat-bubble-admin { background-color: #374151; }
    </style>
</head>
<body class="bg-primary text-primary">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef, useMemo } = React;
        const { 
            initializeApp, getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut, updateProfile,
            getFirestore, collection, onSnapshot, addDoc, doc, deleteDoc, setDoc, serverTimestamp, query, where, orderBy, updateDoc, getDocs, increment, getDoc
        } = window.firebase;

        // --- App Configuration ---
        const firebaseConfig = {
            apiKey: "AIzaSyC7smDYoy-LT58xCwjJsc9uZU9CgHQv5dM",
            authDomain: "ya-buxgalter.firebaseapp.com",
            projectId: "ya-buxgalter",
            storageBucket: "ya-buxgalter.appspot.com",
            messagingSenderId: "640345805387",
            appId: "1:640345805387:web:a1adade77f809af84cb3ce",
            measurementId: "G-0TKE25JVXG"
        };
        const ADMIN_UID = 'vhmtXZxkZnOWviNQ39R1W3GE8mw2'; // ВАШ UID УСТАНОВЛЕН
        const IMGBB_API_KEY = '96bf3f29606f1989bb5a450ad3770cce'; // ВАШ КЛЮЧ УСТАНОВЛЕН

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();

        const logoBase64 = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD/2wBDAQMDAwQDBAgEBAgQCwkLEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBD/wAARCAHgAeADASIAAhEBAxEB/8QAGwABAAMBAQEBAAAAAAAAAAAAAAUGBwEDBAj/xABFEAABAwQBAgMDBwgIBgMAAAAAAQIDBAURBhIhMQcTQRQiUWEVMoGRFhcjQlJjc3WhscEkNDU2U1V2gpLS8CRigpOi0fH/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8A/RMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACldLdY22z0dJaqKsrLhXyLDT0tNGks0z+eyI1fU9kRFVVVEREVS/lZ2y3XGjqaG40lPXUVQxYpqeqhbLFLGvVFRyKiovzITL4gLzU2LhG/3GgqH0tdS2+eWnqI11PiesZqjk+aKqIqD503H4g+J7pfrtQ8G8J0t5tNrnWlqa6pY9zqiVqqjkaiSMRVRUVURqOVERE11VVPt8OvHlHx3aK5ZKJbXe7XIklfQo5XMRjsqj43KiKqIqOaqKiKqKnTVF8h8K/wAFvE914X4m4k48rL/AG271V3rUq6O3W+vjp6K2xOcr0RzVXVz9Lw1VFVVVVVV1RVT6/wAM/GVx4J+K3jLgPjG9T3e31NfV09ru9fMssqK2R6U6yPVdXNVjVjVV11aqa6I1A/WIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD43O5UVpoJKi4VlPQ07NVdNUytjYmvTVzkREPsQ+JxFxRZeE7JU3q/XCnoLdTMV8k0z0b2TSIi6ucvkiIqqukREAp/iA+J+w8C2+qjpKuivN+RqtpLVDUNe5X9kWRG6qxi91VdKqIqIqqqIeE8BfFxxTx5x3frZxdV09LQXGgWqobJDAxjadjHor2xORqPcjmayarI5y6q7VdIiJ8r4X+Ea34leM+IuO+OqVl4t9NVrT0NrqNVp3v0RzY0avVkbGsRF00cqqqqq66/d+F2z0vD3xocb2K1U6UVpoqO4w0lMxzla2NlZTRsRFcqrqjURE1VfID9XgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACm/E1w9X8U8GXu0WqGOe4V1vnp6eOWVIkWR7FRqK5yoiJqveqgXADPz34IeL+D+I7Lw3x1w5BQ2e81TaSnr462KRWSPVERVRiqqoiqiKq6oiqiqiaqp9L4iPg/4l4j4/t/GvB15t1uvdK2Fr4blG9Yn+G5Va5Fa1y66KqKiomlRE0vVQP0CDI+H+HqK/1vE9NbqWnvNdAykrK1kSI+ogY5XNje7vRqOVVRPmq+YAAAAAAAAAAAAAAAD43O3UVzo56K4U0NbR1DFjmgqY0kjkYvVFRyKqKi+aKh9gBkPFfA3xH/AA18T3K58O8S2+y8L3OrWqZaqeGRlTTMcu1Y1zWsVqIjlcjUV7tIiKqL0P0v4feBrb4feE6GwW6V1Q+N7qipq3t1dUzP01e5NdUREajUTXRGom1XVVPQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA-";

        // --- Helper Components ---
        const Logo = () => ( <div className="flex items-center space-x-2 cursor-pointer"> <img src={logoBase64} alt="Asonik Store Logo" className="h-12 w-12 object-contain"/> <span className="text-2xl md:text-3xl font-bold text-primary tracking-wider"> Asonik <span className="accent-text">Store</span> </span> </div> );
        const LoadingSpinner = () => ( <div className="bg-primary min-h-screen flex items-center justify-center"><div className="animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 accent-border"></div></div> );
        const Modal = ({ children, onClose, size = 'max-w-md' }) => ( <div className="fixed inset-0 bg-black bg-opacity-75 z-50 flex justify-center items-center p-4 transition-opacity duration-300"> <div className={`bg-secondary rounded-2xl shadow-2xl p-6 md:p-8 w-full ${size} relative border-color transform transition-transform duration-300 scale-95 animate-scale-in`}> <button onClick={onClose} className="absolute top-4 right-4 text-secondary hover:text-primary transition-colors z-10"> <svg xmlns="http://www.w3.org/2000/svg" className="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg> </button> {children} </div> <style>{` @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } } .animate-scale-in { animation: scale-in 0.3s ease-out forwards; } `}</style> </div> );
        const AlertModal = ({ message, onConfirm, onCancel, t }) => ( <Modal onClose={onCancel}> <div className="text-center"> <h2 className="text-2xl font-bold text-primary mb-4">{t.confirmation}</h2> <p className="text-secondary mb-6">{message}</p> <div className={`flex ${onConfirm ? 'justify-between' : 'justify-center'} space-x-4`}> <button onClick={onCancel} className="bg-tertiary hover:bg-gray-700 text-primary font-bold py-2 px-6 rounded-lg transition-colors">{onConfirm ? t.cancel : t.ok}</button> {onConfirm && ( <button onClick={onConfirm} className="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">{t.confirm}</button> )} </div> </div> </Modal> );
        
        const ProfileModal = ({ user, onClose, t, setAlertInfo }) => {
            const [isUploading, setIsUploading] = useState(false);
            const [color, setColor] = useState('#8b5cf6');
            const fileInputRef = useRef(null);

            const handleImageUpload = async (file) => {
                if (!file) return;
                if (!IMGBB_API_KEY || IMGBB_API_KEY === 'ВАШ_КЛЮЧ_API') {
                    setAlertInfo({ message: t.noApiKey });
                    return;
                }
                setIsUploading(true);
                const formData = new FormData();
                formData.append('image', file);

                try {
                    const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                        method: 'POST',
                        body: formData,
                    });
                    const result = await response.json();
                    if (result.success) {
                        await updateProfile(auth.currentUser, { photoURL: result.data.url });
                        setAlertInfo({ message: t.avatarUpdated });
                    } else { throw new Error(result.error.message); }
                } catch (error) { setAlertInfo({ message: t.errorOccurred }); } 
                finally { setIsUploading(false); onClose(); }
            };
            
            const handleColorAvatar = async () => {
                const colorHex = color.substring(1);
                const photoURL = `https://placehold.co/128x128/${colorHex}/FFFFFF?text=${user.displayName.charAt(0)}`;
                try {
                    await updateProfile(auth.currentUser, { photoURL });
                    setAlertInfo({ message: t.avatarUpdated });
                } catch(error) { setAlertInfo({ message: t.errorOccurred }); }
                finally { onClose(); }
            };

            const handleRevertAvatar = async () => {
                const originalPhotoURL = auth.currentUser.providerData[0]?.photoURL;
                if (originalPhotoURL) {
                    try {
                        await updateProfile(auth.currentUser, { photoURL: originalPhotoURL });
                        setAlertInfo({ message: t.avatarReverted });
                    } catch (error) { setAlertInfo({ message: t.errorOccurred }); } 
                    finally { onClose(); }
                }
            };

            return (
                <Modal onClose={onClose}>
                    <div className="text-center text-primary">
                        <h2 className="text-3xl font-bold mb-4">{t.profile}</h2>
                        <img src={user.photoURL} alt={user.displayName} className="w-24 h-24 rounded-full mx-auto mb-4 border-4 accent-border object-cover"/>
                        <p className="text-xl mb-2">{user.displayName}</p>
                        <p className="text-secondary mb-6">{user.email}</p>
                        <div className="space-y-3">
                            <button onClick={() => fileInputRef.current.click()} className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors">{t.uploadAvatar}</button>
                            <div className="flex items-center space-x-2">
                                <button onClick={handleColorAvatar} className="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition-colors">{t.setColorAvatar}</button>
                                <input type="color" value={color} onChange={e => setColor(e.target.value)} className="p-1 h-10 w-14 block bg-tertiary border-color cursor-pointer rounded-lg"/>
                            </div>
                            <button onClick={handleRevertAvatar} className="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition-colors">{t.revertAvatar}</button>
                        </div>
                        <input type="file" ref={fileInputRef} onChange={(e) => handleImageUpload(e.target.files[0])} accept="image/*" className="hidden"/>
                        {isUploading && <p className="accent-text mt-4">{t.uploadingAvatar}...</p>}
                    </div>
                </Modal>
            );
        };

        const CustomSelector = ({ value, onChange, options }) => {
            const [isOpen, setIsOpen] = useState(false);
            const wrapperRef = useRef(null);

            useEffect(() => {
                function handleClickOutside(event) {
                    if (wrapperRef.current && !wrapperRef.current.contains(event.target)) {
                        setIsOpen(false);
                    }
                }
                document.addEventListener("mousedown", handleClickOutside);
                return () => document.removeEventListener("mousedown", handleClickOutside);
            }, [wrapperRef]);

            const handleSelect = (newValue) => {
                onChange({ target: { value: newValue } });
                setIsOpen(false);
            };

            return (
                <div className="relative" ref={wrapperRef}>
                    <button onClick={() => setIsOpen(!isOpen)} className="flex items-center justify-between w-full bg-tertiary hover:bg-gray-700 text-primary font-semibold py-2 px-4 rounded-lg transition-colors">
                        <span>{options.find(o => o.value === value).label}</span>
                        <svg className={`w-4 h-4 transition-transform ${isOpen ? 'transform rotate-180' : ''}`} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    {isOpen && (
                        <div className="absolute right-0 mt-2 w-full bg-tertiary rounded-md shadow-lg py-1 z-50 border-color">
                            {options.map(opt => (
                                <a href="#" key={opt.value} onClick={(e) => { e.preventDefault(); handleSelect(opt.value); }}
                                   className={`block px-4 py-2 text-sm text-secondary hover:text-primary hover:accent-bg ${value === opt.value ? 'accent-bg text-white' : ''}`}>
                                    {opt.label}
                                </a>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        // --- Main Components ---
        function Header({ user, onLogin, onLogout, setPage, isAdmin, t, currency, setCurrency, language, setLanguage, setProfileVisible, theme, setTheme }) {
            const [userDropdownOpen, setUserDropdownOpen] = useState(false);
            const userDropdownRef = useRef(null);

            const langOptions = [{value: 'ru', label: t.russian}, {value: 'en', label: t.english}, {value: 'uz', label: t.uzbek}];
            const currencyOptions = [{value: 'RUB', label: t.ruble}, {value: 'USD', label: t.dollar}, {value: 'UZS', label: t.sum}];
            const themeOptions = [{value: 'dark', label: t.darkTheme}, {value: 'light', label: t.lightTheme}, {value: 'asonik', label: t.asonikTheme}];

            useEffect(() => {
                function handleClickOutside(event) {
                    if (userDropdownRef.current && !userDropdownRef.current.contains(event.target)) {
                        setUserDropdownOpen(false);
                    }
                }
                document.addEventListener("mousedown", handleClickOutside);
                return () => document.removeEventListener("mousedown", handleClickOutside);
            }, [userDropdownRef]);


            return (
                <header className="bg-secondary p-4 shadow-lg sticky top-0 z-40 border-b border-color">
                    <div className="container mx-auto flex justify-between items-center">
                        <div onClick={() => setPage('home')}><Logo /></div>
                        <nav className="hidden md:flex items-center space-x-6">
                            <button onClick={() => setPage('home')} className="text-secondary hover:text-primary font-medium transition-colors">{t.home}</button>
                            <button onClick={() => setPage('support')} className="text-secondary hover:text-primary font-medium transition-colors">{t.support}</button>
                            <button onClick={() => setPage('faq')} className="text-secondary hover:text-primary font-medium transition-colors">{t.faq}</button>
                            {isAdmin && <button onClick={() => setPage('admin')} className="text-red-500 hover:text-red-400 font-bold transition-colors">{t.adminPanelTitle}</button>}
                        </nav>
                        <div className="flex items-center space-x-2 sm:space-x-4">
                            <div className="w-28"><CustomSelector value={language} onChange={e => setLanguage(e.target.value)} options={langOptions} /></div>
                            <div className="w-28"><CustomSelector value={currency} onChange={e => setCurrency(e.target.value)} options={currencyOptions} /></div>
                            <div className="w-32"><CustomSelector value={theme} onChange={e => setTheme(e.target.value)} options={themeOptions} /></div>
                            
                            {user ? (
                                <div className="relative" ref={userDropdownRef}>
                                    <button onClick={() => setUserDropdownOpen(!userDropdownOpen)} className="flex items-center space-x-2">
                                        <img src={user.photoURL} alt={user.displayName} className="h-10 w-10 rounded-full border-2 accent-border object-cover" />
                                        <svg className={`w-4 h-4 text-primary transition-transform ${userDropdownOpen ? 'transform rotate-180' : ''}`} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7"></path></svg>
                                    </button>
                                    {userDropdownOpen && (
                                        <div className={`absolute right-0 mt-2 w-48 bg-secondary rounded-md shadow-lg py-1 z-50 border-color`}>
                                            <a href="#" onClick={(e) => { e.preventDefault(); setProfileVisible(true); setUserDropdownOpen(false); }} className="block px-4 py-2 text-sm text-secondary hover:text-primary hover:accent-bg">{t.profile}</a>
                                            <a href="#" onClick={(e) => { e.preventDefault(); onLogout(); setUserDropdownOpen(false); }} className="block px-4 py-2 text-sm text-secondary hover:text-primary hover:accent-bg">{t.logout}</a>
                                        </div>
                                    )}
                                </div>
                            ) : (
                                <button onClick={onLogin} className="accent-bg hover:accent-bg-secondary text-white font-bold py-2 px-4 rounded-lg transition-transform transform hover:scale-105 flex items-center space-x-2">
                                    <span>{t.login}</span>
                                </button>
                            )}
                        </div>
                    </div>
                </header>
            );
        }
        
        function HomePage({ products, onProductClick, user, setAlertInfo, t, currency, convertPrice }) {
            const [searchTerm, setSearchTerm] = useState('');
            const [filterCategory, setFilterCategory] = useState('all');
            const [sortBy, setSortBy] = useState('new');

            const filteredAndSortedProducts = useMemo(() => {
                return products
                    .filter(p => p.name.toLowerCase().includes(searchTerm.toLowerCase()))
                    .filter(p => filterCategory === 'all' || p.category === filterCategory)
                    .sort((a, b) => {
                        if (a.pinned && !b.pinned) return -1;
                        if (!a.pinned && b.pinned) return 1;
                        if (sortBy === 'popular') return (b.popularity || 0) - (a.popularity || 0);
                        return b.createdAt?.toMillis() - a.createdAt?.toMillis();
                    });
            }, [products, searchTerm, filterCategory, sortBy]);

            const FilterButton = ({ value, state, setState, children }) => (
                <button
                    onClick={() => setState(value)}
                    className={`px-4 py-2 rounded-lg text-sm transition-colors ${state === value ? 'accent-bg text-white' : 'bg-tertiary text-primary hover:bg-gray-600'}`}
                >
                    {children}
                </button>
            );

            const categories = useMemo(() => {
                const cats = { all: t.all };
                products.forEach(p => {
                    if (p.category) cats[p.category] = p.category;
                });
                return Object.keys(cats).map(key => ({ value: key, label: t[key.toLowerCase()] || key }));
            }, [products, t]);

            return (
                <main className="container mx-auto p-4 md:p-8">
                    <h1 className="text-4xl md:text-5xl font-black text-primary text-center mb-4 tracking-wide">{t.catalogTitle}</h1>
                    <p className="accent-text text-center mb-8 text-lg">{t.catalogSubtitle}</p>
                    
                    <div className="bg-secondary p-4 rounded-xl mb-8 flex flex-col md:flex-row gap-4 items-center">
                        <input
                            type="text"
                            placeholder={t.searchPlaceholder}
                            value={searchTerm}
                            onChange={e => setSearchTerm(e.target.value)}
                            className="w-full md:w-1/3 p-3 bg-tertiary rounded-lg border-color focus:outline-none focus:ring-2 accent-border text-primary"
                        />
                        <div className="flex items-center gap-2">
                            <span className="text-secondary font-semibold">{t.category}:</span>
                            <div className="w-40"><CustomSelector value={filterCategory} onChange={e => setFilterCategory(e.target.value)} options={categories} /></div>
                        </div>
                        <div className="flex items-center gap-2 ml-auto">
                            <span className="text-secondary font-semibold">{t.sortBy}:</span>
                            <FilterButton value="new" state={sortBy} setState={setSortBy}>{t.newSort}</FilterButton>
                            <FilterButton value="popular" state={sortBy} setState={setSortBy}>{t.popularSort}</FilterButton>
                        </div>
                    </div>

                    {filteredAndSortedProducts.length === 0 ? (
                         <p className="text-center text-secondary text-xl mt-12">{t.productsNotFound}</p>
                    ) : (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                            {filteredAndSortedProducts.map(product => (
                                <ProductCard key={product.id} {...{product, onProductClick, user, setAlertInfo, t, currency, convertPrice}} />
                            ))}
                        </div>
                    )}
                </main>
            );
        }

        function ProductCard({ product, onProductClick, user, setAlertInfo, t, currency, convertPrice }) {
            const handleCardClick = () => {
                if(user) {
                    onProductClick(product);
                } else {
                    setAlertInfo({ message: t.loginToView });
                }
            };
            
            return (
                <div onClick={handleCardClick} className="bg-secondary rounded-2xl overflow-hidden shadow-lg border-color transform hover:-translate-y-2 transition-transform duration-300 flex flex-col cursor-pointer">
                    {product.pinned && <div className="absolute top-0 right-0 accent-bg text-white text-xs font-bold px-3 py-1 rounded-bl-lg">{t.pinned}</div>}
                    <img className="w-full h-56 object-cover" src={product.imageUrl} alt={product.name} onError={(e) => { e.target.onerror = null; e.target.src=`https://placehold.co/600x400/1f2937/374151?text=${encodeURIComponent(t.imageNotFound)}`; }}/>
                    <div className="p-6 flex flex-col flex-grow">
                        <h3 className="text-2xl font-bold text-primary mb-1">{product.name}</h3>
                        {product.nominal && <p className="accent-text font-semibold mb-2">{product.nominal}</p>}
                        <div className="flex-grow"></div>
                        <div className="flex justify-between items-center mt-4">
                            <span className="text-3xl font-bold accent-text">{convertPrice(product.price, currency)}</span>
                        </div>
                    </div>
                </div>
            );
        }

        function ProductModal({ product, onClose, onBuy, setAlertInfo, t, currency, convertPrice }) {
             const handleShare = () => {
                const productUrl = `${window.location.origin}${window.location.pathname}?product=${product.id}`;
                navigator.clipboard.writeText(productUrl).then(() => {
                    setAlertInfo({ message: t.linkCopied });
                }, () => {
                    const dummy = document.createElement('textarea');
                    document.body.appendChild(dummy);
                    dummy.value = productUrl;
                    dummy.select();
                    document.execCommand('copy');
                    document.body.removeChild(dummy);
                    setAlertInfo({ message: t.linkCopied });
                });
            };

            return (
                <Modal onClose={onClose} size="max-w-4xl">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <img src={product.imageUrl} alt={product.name} className="w-full h-auto object-cover rounded-lg"/>
                        <div className="flex flex-col">
                            <h2 className="text-4xl font-bold text-primary mb-2">{product.name}</h2>
                            {product.nominal && <p className="text-xl accent-text font-semibold mb-4">{product.nominal}</p>}
                            <p className="text-secondary mb-6 flex-grow">{product.description}</p>
                            <div className="flex justify-between items-center">
                                <span className="text-5xl font-bold accent-text">{convertPrice(product.price, currency)}</span>
                                <div className="flex space-x-2">
                                    <button onClick={handleShare} className="bg-tertiary hover:bg-gray-700 p-4 rounded-lg transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 text-primary" viewBox="0 0 20 20" fill="currentColor"><path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z" /></svg>
                                    </button>
                                    <button onClick={() => onBuy(product)} className="accent-bg hover:accent-bg-secondary text-white font-bold py-4 px-8 rounded-lg text-lg">{t.buy}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </Modal>
            );
        }

        function PurchaseModal({ product, onClose, onConfirm, t }) {
            const handleContactSeller = async () => {
                await onConfirm(product);
                window.open('https://t.me/asonikofficial', '_blank');
                onClose();
            };

            return (
                <Modal onClose={onClose}>
                    <div className="text-center">
                        <h2 className="text-3xl font-bold text-primary mb-2">{t.checkout}</h2>
                        <p className="text-secondary mb-6">{t.youAreBuying}: <span className="font-bold accent-text">{product.name}</span></p>
                        <div className="space-y-4">
                            <h3 className="text-xl text-primary">{t.choosePayment}</h3>
                            <button onClick={handleContactSeller} className="w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">{t.contactSeller}</button>
                            <button disabled className="w-full bg-gray-600 text-gray-400 font-bold py-3 px-4 rounded-lg cursor-not-allowed">YooMoney ({t.unavailable})</button>
                            <button disabled className="w-full bg-gray-600 text-gray-400 font-bold py-3 px-4 rounded-lg cursor-not-allowed">{t.cardPayment} ({t.unavailable})</button>
                            <button disabled className="w-full bg-gray-600 text-gray-400 font-bold py-3 px-4 rounded-lg cursor-not-allowed">{t.bankTransfer} ({t.unavailable})</button>
                        </div>
                    </div>
                </Modal>
            );
        }

        function ChatModal({ ticketId, user, isAdmin, onClose, t }) {
            const [messages, setMessages] = useState([]);
            const [newMessage, setNewMessage] = useState('');
            const chatEndRef = useRef(null);

            useEffect(() => {
                const messagesQuery = query(collection(db, 'supportTickets', ticketId, 'messages'), orderBy('timestamp'));
                const unsubscribe = onSnapshot(messagesQuery, snapshot => {
                    setMessages(snapshot.docs.map(doc => doc.data()));
                });
                return unsubscribe;
            }, [ticketId]);

            useEffect(() => {
                chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [messages]);

            const handleSendMessage = async (e) => {
                e.preventDefault();
                if (!newMessage.trim()) return;
                await addDoc(collection(db, 'supportTickets', ticketId, 'messages'), {
                    text: newMessage,
                    senderId: user.uid,
                    senderName: isAdmin ? 'Admin' : user.displayName,
                    timestamp: serverTimestamp()
                });
                await updateDoc(doc(db, 'supportTickets', ticketId), {
                    lastMessage: newMessage,
                    lastUpdated: serverTimestamp(),
                    status: isAdmin ? 'answered' : 'pending'
                });
                setNewMessage('');
            };

            return (
                <Modal onClose={onClose} size="max-w-2xl">
                    <div className="flex flex-col h-[70vh]">
                        <h2 className="text-2xl font-bold text-primary mb-4 text-center">{t.chatWithAdmin}</h2>
                        <div className="flex-grow bg-primary rounded-lg p-4 overflow-y-auto mb-4">
                            {messages.map((msg, index) => (
                                <div key={index} className={`flex my-2 ${msg.senderId === user.uid ? 'justify-end' : 'justify-start'}`}>
                                    <div className={`chat-bubble rounded-lg p-3 text-white ${msg.senderId === user.uid ? 'chat-bubble-user' : 'chat-bubble-admin'}`}>
                                        <p className="font-bold text-sm">{msg.senderName}</p>
                                        <p>{msg.text}</p>
                                        <p className="text-xs text-gray-400 text-right mt-1">{msg.timestamp ? new Date(msg.timestamp.toDate()).toLocaleTimeString() : '...'}</p>
                                    </div>
                                </div>
                            ))}
                            <div ref={chatEndRef} />
                        </div>
                        <form onSubmit={handleSendMessage} className="flex space-x-2">
                            <input type="text" value={newMessage} onChange={e => setNewMessage(e.target.value)} placeholder={t.enterMessagePlaceholder} className="w-full p-3 bg-tertiary rounded-lg border-color focus:outline-none focus:ring-2 accent-ring text-primary" />
                            <button type="submit" className="accent-bg hover:accent-bg-secondary text-white font-bold p-3 rounded-lg"><svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg></button>
                        </form>
                    </div>
                </Modal>
            );
        }

        function SupportPage({ user, t, setActiveTicketId }) {
            const handleCreateTicket = async () => {
                const ticketRef = doc(db, 'supportTickets', user.uid);
                const ticketSnap = await getDoc(ticketRef);

                if (!ticketSnap.exists()) {
                    await setDoc(ticketRef, {
                        userId: user.uid,
                        userEmail: user.email,
                        userName: user.displayName,
                        subject: `${t.chatWith} ${user.displayName}`,
                        status: 'new',
                        lastUpdated: serverTimestamp(),
                        createdAt: serverTimestamp()
                    });
                }
                setActiveTicketId(user.uid);
            };
            
            return (
                <div className="container mx-auto p-4 md:p-8 text-primary flex justify-center items-center h-full">
                    <div className="text-center">
                        <h1 className="text-4xl font-bold mb-4">{t.support}</h1>
                        <p className="text-secondary mb-8">{t.supportSubtitle}</p>
                        <button onClick={handleCreateTicket} className="accent-bg hover:accent-bg-secondary text-white font-bold py-3 px-6 rounded-lg text-lg">
                            {t.chatWithAdmin}
                        </button>
                    </div>
                </div>
            );
        }

        function FAQPage({ faqs }) {
            const [openIndex, setOpenIndex] = useState(null);

            return (
                <div className="container mx-auto p-4 md:p-8">
                    <h1 className="text-4xl font-bold text-center mb-8 text-primary">Часто задаваемые вопросы</h1>
                    <div className="space-y-4 max-w-3xl mx-auto">
                        {faqs.map((faq, index) => (
                            <div key={faq.id} className="bg-secondary rounded-lg">
                                <button onClick={() => setOpenIndex(openIndex === index ? null : index)} className="w-full text-left p-4 flex justify-between items-center">
                                    <span className="font-semibold text-primary">{faq.question}</span>
                                    <svg className={`w-6 h-6 transform transition-transform text-primary ${openIndex === index ? 'rotate-180' : ''}`} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7"></path></svg>
                                </button>
                                {openIndex === index && (
                                    <div className="p-4 border-t border-color text-secondary">
                                        {faq.answer}
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function AdminPage({ products, faqs, setAlertInfo, t, setActiveTicketId }) {
            const [view, setView] = useState('dashboard');
            const [tickets, setTickets] = useState([]);
            const [orders, setOrders] = useState([]);
            const [name, setName] = useState('');
            const [description, setDescription] = useState('');
            const [price, setPrice] = useState('');
            const [imageUrl, setImageUrl] = useState('');
            const [isPinned, setIsPinned] = useState(false);
            const [category, setCategory] = useState('');
            const [nominal, setNominal] = useState('');
            const [editingProduct, setEditingProduct] = useState(null);
            const [orderFilter, setOrderFilter] = useState('all');
            const [isLoading, setIsLoading] = useState(false);
            const fileInputRef = useRef(null);
            const [faqQuestion, setFaqQuestion] = useState('');
            const [faqAnswer, setFaqAnswer] = useState('');
            const [editingFaq, setEditingFaq] = useState(null);

            useEffect(() => {
                const ticketsQuery = query(collection(db, 'supportTickets'), orderBy('lastUpdated', 'desc'));
                const unsubTickets = onSnapshot(ticketsQuery, snapshot => setTickets(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))));
                const ordersQuery = query(collection(db, 'orders'), orderBy('timestamp', 'desc'));
                const unsubOrders = onSnapshot(ordersQuery, snapshot => setOrders(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))));
                return () => { unsubTickets(); unsubOrders(); };
            }, []);
            
            const filteredOrders = useMemo(() => {
                if (orderFilter === 'all') return orders;
                const now = new Date();
                const filterDate = new Date();
                if (orderFilter === 'today') filterDate.setHours(0, 0, 0, 0);
                else if (orderFilter === '3days') filterDate.setDate(now.getDate() - 3);
                else if (orderFilter === 'month') filterDate.setMonth(now.getMonth() - 1);
                return orders.filter(order => order.timestamp && order.timestamp.toDate() >= filterDate);
            }, [orders, orderFilter]);
            
            const resetForm = () => {
                setName(''); setDescription(''); setPrice(''); setNominal('');
                setImageUrl(''); setEditingProduct(null); setIsPinned(false); setCategory('');
            };

             const handleImageUpload = async (file) => {
                if (!file) return;
                if (!IMGBB_API_KEY || IMGBB_API_KEY === 'ВАШ_КЛЮЧ_API') {
                    setAlertInfo({ message: t.noApiKey });
                    return;
                }
                setIsLoading(true);
                const formData = new FormData();
                formData.append('image', file);

                try {
                    const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                        method: 'POST',
                        body: formData,
                    });
                    const result = await response.json();
                    if (result.success) {
                        setImageUrl(result.data.url);
                        setAlertInfo({ message: t.imageUploaded });
                    } else { throw new Error(result.error.message); }
                } catch (error) { setAlertInfo({ message: t.errorOccurred }); } 
                finally { setIsLoading(false); }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!name || !description || !price || !imageUrl) { setAlertInfo({ message: t.fillAllFields }); return; }
                setIsLoading(true);
                
                const productData = { name, description, price: Number(price), imageUrl, nominal, pinned: isPinned, category, createdAt: serverTimestamp(), popularity: editingProduct?.popularity || 0 };
                
                try {
                    if (editingProduct) {
                        await setDoc(doc(db, 'products', editingProduct.id), productData);
                        setAlertInfo({ message: t.productUpdated });
                    } else {
                        await addDoc(collection(db, 'products'), productData);
                        setAlertInfo({ message: t.productAdded });
                    }
                    resetForm();
                    setView('viewProducts');
                } catch (error) { setAlertInfo({ message: t.errorOccurred }); }
                finally { setIsLoading(false); }
            };

            const handleDeleteOrder = (orderId) => {
                setAlertInfo({
                    message: t.confirmDeleteOrder,
                    onConfirm: async () => {
                        try {
                            await deleteDoc(doc(db, 'orders', orderId));
                            setAlertInfo({ message: t.orderDeleted });
                        } catch (error) { setAlertInfo({ message: t.errorOccurred }); }
                    }
                });
            };
            
            const handleEdit = (product) => {
                setEditingProduct(product);
                setName(product.name); setDescription(product.description); setPrice(product.price);
                setNominal(product.nominal || ''); setIsPinned(product.pinned || false); setCategory(product.category || 'games');
                setImageUrl(product.imageUrl);
                setView('addProduct');
            };
            
            const handleFaqSubmit = async (e) => {
                e.preventDefault();
                if (!faqQuestion || !faqAnswer) return;
                const faqData = { question: faqQuestion, answer: faqAnswer };
                try {
                    if (editingFaq) {
                        await setDoc(doc(db, 'faq', editingFaq.id), faqData);
                    } else {
                        await addDoc(collection(db, 'faq'), faqData);
                    }
                    setFaqQuestion(''); setFaqAnswer(''); setEditingFaq(null);
                } catch (error) { console.error(error); }
            };

            const handleEditFaq = (faq) => {
                setEditingFaq(faq);
                setFaqQuestion(faq.question);
                setFaqAnswer(faq.answer);
            };

            const handleDeleteFaq = async (id) => {
                await deleteDoc(doc(db, 'faq', id));
            };

            return (
                <div className="container mx-auto p-4 md:p-8 text-primary">
                    <h1 className="text-4xl font-bold mb-8 text-center">{t.adminPanelTitle}</h1>

                    {view === 'dashboard' && (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                            <button onClick={() => setView('viewProducts')} className="bg-purple-600 hover:bg-purple-700 p-8 rounded-lg text-2xl font-bold text-white">{t.manageProducts}</button>
                            <button onClick={() => { setEditingProduct(null); resetForm(); setView('addProduct'); }} className="bg-green-600 hover:bg-green-700 p-8 rounded-lg text-2xl font-bold text-white">{t.addProduct}</button>
                            <button onClick={() => setView('manageFAQ')} className="bg-yellow-500 hover:bg-yellow-600 p-8 rounded-lg text-2xl font-bold text-white">{t.manageFaq}</button>
                        </div>
                    )}
                    
                    {view === 'addProduct' && (
                        <div>
                            <button onClick={() => setView('dashboard')} className="mb-4 bg-tertiary p-2 rounded-lg">← {t.backToPanel}</button>
                            <div className="bg-secondary p-8 rounded-2xl border-color">
                                <h2 className="text-2xl font-bold mb-6 text-primary">{editingProduct ? t.editProduct : t.addProduct}</h2>
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <input type="text" placeholder={t.productName} value={name} onChange={e => setName(e.target.value)} className="w-full p-3 bg-tertiary rounded-lg border-color focus:outline-none focus:ring-2 accent-border text-primary" />
                                    <input type="text" placeholder={t.productNominal} value={nominal} onChange={e => setNominal(e.target.value)} className="w-full p-3 bg-tertiary rounded-lg border-color focus:outline-none focus:ring-2 accent-border text-primary" />
                                    <textarea placeholder={t.description} value={description} onChange={e => setDescription(e.target.value)} className="w-full p-3 bg-tertiary rounded-lg border-color focus:outline-none focus:ring-2 accent-border text-primary h-32"></textarea>
                                    <input type="number" placeholder={t.priceInRub} value={price} onChange={e => setPrice(e.target.value)} className="w-full p-3 bg-tertiary rounded-lg border-color focus:outline-none focus:ring-2 accent-border text-primary" />
                                    
                                    <div className="space-y-2">
                                        <label className="block text-secondary">{t.productImage}</label>
                                        <div className="flex items-center space-x-2">
                                            <input type="text" placeholder={t.imageUrl} value={imageUrl} onChange={e => setImageUrl(e.target.value)} className="w-full p-3 bg-tertiary rounded-lg border-color focus:outline-none focus:ring-2 accent-border text-primary" />
                                            <button type="button" onClick={() => fileInputRef.current.click()} className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg">{t.uploadFile}</button>
                                        </div>
                                        <input type="file" ref={fileInputRef} onChange={(e) => handleImageUpload(e.target.files[0])} accept="image/*" className="hidden"/>
                                    </div>
                                    
                                    <div className="flex justify-between items-center">
                                        <div className="flex items-center space-x-3">
                                            <label htmlFor="category" className="text-secondary">{t.category}:</label>
                                            <input type="text" id="category" value={category} onChange={e => setCategory(e.target.value)} className="p-2 bg-tertiary rounded-lg border-color text-primary" placeholder="e.g., Shooters"/>
                                        </div>
                                        <div className="flex items-center space-x-3">
                                            <input type="checkbox" id="isPinned" checked={isPinned} onChange={e => setIsPinned(e.target.checked)} className="h-5 w-5 rounded accent-bg focus:ring-purple-500"/>
                                            <label htmlFor="isPinned" className="text-secondary">{t.pinProduct}</label>
                                        </div>
                                    </div>
                                    <div className="flex space-x-4">
                                        <button type="submit" disabled={isLoading} className="w-full accent-bg hover:accent-bg-secondary text-white font-bold py-3 px-4 rounded-lg transition-colors disabled:bg-gray-500">{isLoading ? t.loading : (editingProduct ? t.updateProduct : t.addProductBtn)}</button>
                                        {editingProduct && <button type="button" onClick={resetForm} className="w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">{t.cancel}</button>}
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}

                    {view === 'viewProducts' && (
                         <div>
                            <button onClick={() => setView('dashboard')} className="mb-4 bg-tertiary p-2 rounded-lg">← {t.backToPanel}</button>
                            <div className="bg-secondary p-8 rounded-2xl border-color">
                                <h2 className="text-2xl font-bold mb-6 text-primary">{t.productList}</h2>
                                <div className="space-y-4">
                                    {products.map(p => (
                                        <div key={p.id} className="bg-tertiary p-4 rounded-lg flex justify-between items-center">
                                            <div className="flex items-center space-x-4">
                                                <img src={p.imageUrl} className="w-16 h-16 object-cover rounded-md" />
                                                <p className="font-bold text-primary">{p.name} - {p.price}₽</p>
                                            </div>
                                            <div className="flex space-x-2">
                                                <button onClick={() => handleEdit(p)} className="bg-blue-500 hover:bg-blue-600 text-white py-1 px-3 rounded">{t.edit}</button>
                                                <button onClick={() => handleDelete(p.id)} className="bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded">{t.delete}</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {view === 'dashboard' && (
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8">
                            <div className="bg-secondary p-8 rounded-2xl border-color">
                                <h2 className="text-2xl font-bold mb-6">{t.purchaseOrders}</h2>
                                <div className="flex space-x-2 mb-4">
                                    <button onClick={() => setOrderFilter('all')} className={`px-4 py-2 rounded-lg ${orderFilter === 'all' ? 'accent-bg text-white' : 'bg-tertiary text-primary'}`}>{t.all}</button>
                                    <button onClick={() => setOrderFilter('today')} className={`px-4 py-2 rounded-lg ${orderFilter === 'today' ? 'accent-bg text-white' : 'bg-tertiary text-primary'}`}>{t.today}</button>
                                    <button onClick={() => setOrderFilter('3days')} className={`px-4 py-2 rounded-lg ${orderFilter === '3days' ? 'accent-bg text-white' : 'bg-tertiary text-primary'}`}>{t.last3days}</button>
                                    <button onClick={() => setOrderFilter('month')} className={`px-4 py-2 rounded-lg ${orderFilter === 'month' ? 'accent-bg text-white' : 'bg-tertiary text-primary'}`}>{t.lastMonth}</button>
                                </div>
                                <div className="space-y-4 max-h-96 overflow-y-auto">
                                    {filteredOrders.map(order => (
                                        <div key={order.id} className="bg-tertiary p-4 rounded-lg flex justify-between items-center">
                                            <div>
                                                <p><b>{t.product}:</b> {order.productName}</p>
                                                <p><b>{t.user}:</b> {order.userEmail}</p>
                                                <p><b>{t.date}:</b> {new Date(order.timestamp?.toDate()).toLocaleString()}</p>
                                            </div>
                                            <button onClick={() => handleDeleteOrder(order.id)} className="bg-red-600 hover:bg-red-700 p-2 rounded-full text-white">
                                                <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clipRule="evenodd" /></svg>
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <div className="bg-secondary p-8 rounded-2xl border-color">
                                <h2 className="text-2xl font-bold mb-6">{t.supportTickets}</h2>
                                <div className="space-y-4 max-h-96 overflow-y-auto">
                                    {tickets.length > 0 ? tickets.map(ticket => (
                                        <div key={ticket.id} onClick={() => setActiveTicketId(ticket.id)} className="bg-tertiary p-4 rounded-lg flex justify-between items-center cursor-pointer hover:bg-gray-600">
                                            <div>
                                                <p className="font-bold">{ticket.subject}</p>
                                                <p className="text-sm text-secondary">{t.user}: {ticket.userName} ({ticket.userEmail})</p>
                                            </div>
                                            <span className="text-sm text-secondary">{new Date(ticket.lastUpdated?.toDate()).toLocaleString()}</span>
                                        </div>
                                    )) : <p>{t.noTickets}</p>}
                                </div>
                            </div>
                        </div>
                    )}

                    {view === 'manageFAQ' && (
                        <div>
                            <button onClick={() => setView('dashboard')} className="mb-4 bg-tertiary p-2 rounded-lg">← {t.backToPanel}</button>
                            <div className="bg-secondary p-8 rounded-2xl border-color">
                                <h2 className="text-2xl font-bold mb-6 text-primary">{t.manageFaq}</h2>
                                <form onSubmit={handleFaqSubmit} className="space-y-4 mb-8">
                                    <input type="text" placeholder={t.question} value={faqQuestion} onChange={e => setFaqQuestion(e.target.value)} className="w-full p-3 bg-tertiary rounded-lg border-color text-primary" />
                                    <textarea placeholder={t.answer} value={faqAnswer} onChange={e => setFaqAnswer(e.target.value)} className="w-full p-3 bg-tertiary rounded-lg border-color text-primary h-24"></textarea>
                                    <button type="submit" className="accent-bg hover:accent-bg-secondary text-white font-bold py-2 px-4 rounded-lg">{editingFaq ? t.updateFaq : t.addFaq}</button>
                                </form>
                                <div className="space-y-4">
                                    {faqs.map(faq => (
                                        <div key={faq.id} className="bg-tertiary p-4 rounded-lg">
                                            <p className="font-bold text-primary">{faq.question}</p>
                                            <p className="text-secondary">{faq.answer}</p>
                                            <div className="flex space-x-2 mt-2">
                                                <button onClick={() => handleEditFaq(faq)} className="text-blue-400">{t.edit}</button>
                                                <button onClick={() => handleDeleteFaq(faq.id)} className="text-red-400">{t.delete}</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function Footer({t}) {
            return (
                <footer className="bg-secondary text-secondary p-6 mt-12 border-t border-color">
                    <div className="container mx-auto text-center">
                        <p>&copy; {new Date().getFullYear()} Asonik Store. {t.rightsReserved}</p>
                        <p className="text-sm mt-2">{t.developedWithLove}</p>
                    </div>
                </footer>
            );
        }
        
        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [products, setProducts] = useState([]);
            const [faqs, setFaqs] = useState([]);
            const [page, setPage] = useState('home');
            const [alertInfo, setAlertInfo] = useState(null);
            const [language, setLanguage] = useState('ru');
            const [currency, setCurrency] = useState('RUB');
            const [profileVisible, setProfileVisible] = useState(false);
            const [activeTicketId, setActiveTicketId] = useState(null);
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [theme, setTheme] = useState('dark');

            useEffect(() => {
                document.body.className = theme;
            }, [theme]);

            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const productId = params.get('product');
                if (productId && products.length > 0) {
                    const productToShow = products.find(p => p.id === productId);
                    if (productToShow) {
                        setSelectedProduct(productToShow);
                    }
                }
            }, [products]);
            
            const isAdmin = user && user.uid === ADMIN_UID;
            const t = translations[language];
            
            useEffect(() => {
                const unsubscribe = onAuthStateChanged(auth, (currentUser) => {
                    setUser(currentUser);
                    setLoading(false);
                });
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                const q = collection(db, "products");
                const unsubProducts = onSnapshot(q, (snapshot) => {
                    setProducts(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                });
                const unsubFaqs = onSnapshot(collection(db, "faq"), (snapshot) => {
                    setFaqs(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                });
                return () => { unsubProducts(); unsubFaqs(); };
            }, []);

            const handleLogin = async () => { try { await signInWithPopup(auth, provider); } catch (error) { console.error("Login Error:", error); setAlertInfo({ message: "Login failed: " + error.message }); } };
            const handleLogout = async () => { try { await signOut(auth); setPage('home'); } catch (error) { console.error("Logout Error:", error); } };
            const handleBuy = (product) => { /* Logic for purchase modal */ };
            const handleConfirmPurchase = async (product) => {
                if (!user) return;
                try {
                    await addDoc(collection(db, 'orders'), {
                        userId: user.uid, userEmail: user.email, productId: product.id,
                        productName: product.name, timestamp: serverTimestamp()
                    });
                    const productRef = doc(db, 'products', product.id);
                    await updateDoc(productRef, {
                        popularity: increment(1)
                    });
                } catch (error) { console.error("Order creation/popularity update error: ", error); }
            };
            const handleAlertConfirm = () => { if (alertInfo && alertInfo.onConfirm) alertInfo.onConfirm(); setAlertInfo(null); };

            const renderPage = () => {
                switch (page) {
                    case 'admin': return isAdmin ? <AdminPage {...{products, faqs, setAlertInfo, t, setActiveTicketId}} /> : <HomePage {...{products, onProductClick: setSelectedProduct, user, setAlertInfo, t, currency, convertPrice}} />;
                    case 'support': return user ? <SupportPage {...{user, t, setActiveTicketId}}/> : <div className="text-center text-primary p-10">{t.loginForSupport}</div>;
                    case 'faq': return <FAQPage faqs={faqs} />;
                    default: return <HomePage {...{products, onProductClick: setSelectedProduct, user, setAlertInfo, t, currency, convertPrice}} />;
                }
            };

            if (loading) return <LoadingSpinner />;

            return (
                <div className="bg-primary min-h-screen font-sans flex flex-col">
                    <Header {...{user, onLogin: handleLogin, onLogout: handleLogout, setPage, isAdmin, t, currency, setCurrency, language, setLanguage, setProfileVisible, theme, setTheme}} />
                    <div className="flex-grow">{renderPage()}</div>
                    {selectedProduct && user && <ProductModal product={selectedProduct} onClose={() => setSelectedProduct(null)} onBuy={handleBuy} setAlertInfo={setAlertInfo} t={t} currency={currency} convertPrice={convertPrice} />}
                    {activeTicketId && user && <ChatModal ticketId={activeTicketId} user={user} isAdmin={isAdmin} onClose={() => setActiveTicketId(null)} t={t} />}
                    {alertInfo && <AlertModal message={alertInfo.message} onConfirm={alertInfo.onConfirm ? handleAlertConfirm : null} onCancel={() => setAlertInfo(null)} t={t} />}
                    {profileVisible && user && <ProfileModal user={user} onClose={() => setProfileVisible(false)} t={t} setAlertInfo={setAlertInfo} />}
                    <Footer t={t}/>
                </div>
            );
        }
        
        // --- Localization & Currency ---
        const translations = {
            ru: {
                home: 'Главная', support: 'Поддержка', faq: 'FAQ', adminPanelTitle: 'Админ-панель', profile: 'Профиль', logout: 'Выйти', login: 'Войти',
                buy: 'Купить', confirmation: 'Подтверждение', cancel: 'Отмена', ok: 'OK', confirm: 'Подтвердить',
                loginToView: 'Пожалуйста, войдите, чтобы просмотреть детали товара.',
                imageNotFound: 'Изображение не найдено',
                catalogTitle: 'КАТАЛОГ ТОВАРОВ', catalogSubtitle: 'Лучшие предложения только для вас', productsComingSoon: 'Товары скоро появятся...',
                addProduct: 'Добавить новый товар', editProduct: 'Редактировать товар', edit: 'Ред.', delete: 'Удал.',
                productName: 'Название товара', productNominal: 'Номинал (н-р: 100 гемов)', description: 'Описание', priceInRub: 'Цена (в RUB)', imageUrl: 'URL изображения',
                addProductBtn: 'Добавить товар', updateProduct: 'Обновить товар', fillAllFields: 'Пожалуйста, заполните все поля.', productList: 'Список товаров',
                productAdded: 'Товар успешно добавлен!', productUpdated: 'Товар успешно обновлен!', errorOccurred: 'Произошла ошибка.',
                confirmDelete: 'Вы уверены, что хотите удалить этот товар?', productDeleted: 'Товар удален.',
                supportTickets: 'Тикеты поддержки', user: 'Пользователь',
                myTickets: 'Мои обращения', createTicket: 'Написать в поддержку', newTicketFrom: 'Чат с', create: 'Создать',
                noTickets: 'У вас пока нет обращений.', ticket: 'Тикет', lastUpdate: 'Обновлено',
                new: 'Новый', pending: 'В ожидании', answered: 'Отвечен', closed: 'Закрыт',
                loginForSupport: 'Пожалуйста, войдите в аккаунт, чтобы написать в поддержку.',
                avatarUpdated: 'Аватар успешно обновлен!', uploadingAvatar: 'Загрузка аватара', revertAvatar: 'Вернуть исходный аватар', avatarReverted: 'Аватар возвращен.',
                enterMessagePlaceholder: 'Введите ваше сообщение...',
                checkout: 'Оформление заказа', youAreBuying: 'Вы покупаете', choosePayment: 'Выберите способ оплаты',
                contactSeller: 'Связаться с продавцом (Telegram)', unavailable: 'Недоступно', cardPayment: 'Оплата картой', bankTransfer: 'Безналичный расчет',
                rightsReserved: 'Все права защищены.', developedWithLove: 'Дизайн и разработка с ❤️',
                russian: 'Русский', english: 'English', uzbek: 'O\'zbekcha',
                ruble: 'Рубль', dollar: 'Доллар', sum: "So'm",
                purchaseOrders: 'Заявки на покупку', all: 'Все', today: 'За сегодня', last3days: 'За 3 дня', lastMonth: 'За месяц', product: 'Товар', date: 'Дата',
                searchPlaceholder: 'Поиск по названию...', category: 'Категория', games: 'Игры', apps: 'Приложения', sortBy: 'Сортировка', newSort: 'Новые', popularSort: 'Популярные', productsNotFound: 'Товары не найдены',
                pinProduct: 'Закрепить товар', pinned: 'Закреплено', loading: 'Загрузка...',
                uploadFile: 'Загрузить', noApiKey: 'Ключ API для ImgBB не установлен!', imageUploaded: 'Изображение успешно загружено!',
                linkCopied: 'Ссылка скопирована!', confirmDeleteOrder: 'Вы уверены, что хотите удалить эту заявку?', orderDeleted: 'Заявка удалена.',
                manageProducts: 'Управление товарами', backToPanel: 'Назад в панель', uploadAvatar: 'Загрузить аватар',
                chatWithAdmin: 'Чат с администрацией', chatWith: 'Чат с', supportSubtitle: 'Если у вас есть вопросы, нажмите кнопку ниже, чтобы начать чат.',
                darkTheme: 'Темная', lightTheme: 'Светлая', asonikTheme: 'Фирменная', setColorAvatar: 'Установить цвет',
                manageFaq: 'Управление FAQ', question: 'Вопрос', answer: 'Ответ', addFaq: 'Добавить FAQ', updateFaq: 'Обновить FAQ'
            },
            en: {
                // ... English translations
                home: 'Home', support: 'Support', faq: 'FAQ', adminPanelTitle: 'Admin Panel', profile: 'Profile', logout: 'Logout', login: 'Login',
                buy: 'Buy', confirmation: 'Confirmation', cancel: 'Cancel', ok: 'OK', confirm: 'Confirm',
                loginToView: 'Please log in to view product details.',
                imageNotFound: 'Image Not Found',
                catalogTitle: 'PRODUCT CATALOG', catalogSubtitle: 'The best offers just for you', productsComingSoon: 'Products are coming soon...',
                addProduct: 'Add New Product', editProduct: 'Edit Product', edit: 'Edit', delete: 'Del',
                productName: 'Product Name', productNominal: 'Denomination (e.g., 100 gems)', description: 'Description', priceInRub: 'Price (in RUB)', imageUrl: 'Image URL',
                addProductBtn: 'Add Product', updateProduct: 'Update Product', fillAllFields: 'Please fill in all fields.', productList: 'Product List',
                productAdded: 'Product added successfully!', productUpdated: 'Product updated successfully!', errorOccurred: 'An error occurred.',
                confirmDelete: 'Are you sure you want to delete this product?', productDeleted: 'Product deleted.',
                supportTickets: 'Support Tickets', user: 'User',
                myTickets: 'My Tickets', createTicket: 'Contact Support', newTicketFrom: 'Chat with', create: 'Create',
                noTickets: 'You have no tickets yet.', ticket: 'Ticket', lastUpdate: 'Last update',
                new: 'New', pending: 'Pending', answered: 'Answered', closed: 'Closed',
                loginForSupport: 'Please log in to contact support.',
                avatarUpdated: 'Avatar updated successfully!', uploadingAvatar: 'Uploading avatar', revertAvatar: 'Revert to Original Avatar', avatarReverted: 'Avatar reverted.',
                enterMessagePlaceholder: 'Enter your message...',
                checkout: 'Checkout', youAreBuying: 'You are buying', choosePayment: 'Choose payment method',
                contactSeller: 'Contact seller (Telegram)', unavailable: 'Unavailable', cardPayment: 'Card Payment', bankTransfer: 'Bank Transfer',
                rightsReserved: 'All rights reserved.', developedWithLove: 'Designed and developed with ❤️',
                russian: 'Russian', english: 'English', uzbek: 'Uzbek',
                ruble: 'Ruble', dollar: 'Dollar', sum: "So'm",
                purchaseOrders: 'Purchase Orders', all: 'All', today: 'Today', last3days: 'Last 3 days', lastMonth: 'Last month', product: 'Product', date: 'Date',
                searchPlaceholder: 'Search by name...', category: 'Category', games: 'Games', apps: 'Apps', sortBy: 'Sort by', newSort: 'New', popularSort: 'Popular', productsNotFound: 'Products not found',
                pinProduct: 'Pin product', pinned: 'Pinned', loading: 'Loading...',
                uploadFile: 'Upload', noApiKey: 'ImgBB API Key is not set!', imageUploaded: 'Image uploaded successfully!',
                linkCopied: 'Link copied!', confirmDeleteOrder: 'Are you sure you want to delete this order?', orderDeleted: 'Order deleted.',
                manageProducts: 'Manage Products', backToPanel: 'Back to Panel', uploadAvatar: 'Upload Avatar',
                chatWithAdmin: 'Chat with Administration', chatWith: 'Chat with', supportSubtitle: 'If you have questions, press the button below to start a chat.',
                darkTheme: 'Dark', lightTheme: 'Light', asonikTheme: 'Asonik', setColorAvatar: 'Set Color Avatar',
                manageFaq: 'Manage FAQ', question: 'Question', answer: 'Answer', addFaq: 'Add FAQ', updateFaq: 'Update FAQ'
            },
            uz: {
                // ... Uzbek translations
                home: 'Bosh sahifa', support: 'Qo\'llab-quvvatlash', faq: 'FAQ', adminPanelTitle: 'Admin Paneli', profile: 'Profil', logout: 'Chiqish', login: 'Kirish',
                buy: 'Sotib olish', confirmation: 'Tasdiqlash', cancel: 'Bekor qilish', ok: 'OK', confirm: 'Tasdiqlash',
                loginToView: 'Mahsulot tafsilotlarini ko\'rish uchun tizimga kiring.',
                imageNotFound: 'Rasm topilmadi',
                catalogTitle: 'MAHSULOTLAR KATALOGI', catalogSubtitle: 'Eng yaxshi takliflar faqat siz uchun', productsComingSoon: 'Mahsulotlar tez kunda...',
                addProduct: 'Yangi mahsulot qo\'shish', editProduct: 'Mahsulotni tahrirlash', edit: 'Tahr.', delete: 'O\'chr.',
                productName: 'Mahsulot nomi', productNominal: 'Nominal (masalan: 100 gem)', description: 'Tavsif', priceInRub: 'Narx (RUBda)', imageUrl: 'Rasm URL manzili',
                addProductBtn: 'Mahsulot qo\'shish', updateProduct: 'Mahsulotni yangilash', fillAllFields: 'Iltimos, barcha maydonlarni to\'ldiring.', productList: 'Mahsulotlar ro\'yxati',
                productAdded: 'Mahsulot muvaffaqiyatli qo\'shildi!', productUpdated: 'Mahsulot muvaffaqiyatli yangilandi!', errorOccurred: 'Xatolik yuz berdi.',
                confirmDelete: 'Haqiqatan ham ushbu mahsulotni o\'chirib tashlamoqchimisiz?', productDeleted: 'Mahsulot o\'chirildi.',
                supportTickets: 'Qo\'llab-quvvatlash biletlari', user: 'Foydalanuvchi',
                myTickets: 'Mening murojaatlarim', createTicket: 'Qo\'llab-quvvatlashga yozish', newTicketFrom: 'Suhbat', create: 'Yaratish',
                noTickets: 'Sizda hali murojaatlar yo\'q.', ticket: 'Murojaat', lastUpdate: 'Yangilangan',
                new: 'Yangi', pending: 'Kutilmoqda', answered: 'Javob berildi', closed: 'Yopilgan',
                loginForSupport: 'Qo\'llab-quvvatlash xizmatiga yozish uchun tizimga kiring.',
                avatarUpdated: 'Avatar muvaffaqiyatli yangilandi!', uploadingAvatar: 'Avatar yuklanmoqda', revertAvatar: 'Asl avatarga qaytish', avatarReverted: 'Avatar qaytarildi.',
                enterMessagePlaceholder: 'Xabaringizni kiriting...',
                checkout: 'Buyurtmani rasmiylashtirish', youAreBuying: 'Siz xarid qilyapsiz', choosePayment: 'To\'lov usulini tanlang',
                contactSeller: 'Sotuvchi bilan bog\'lanish (Telegram)', unavailable: 'Mavjud emas', cardPayment: 'Karta orqali to\'lov', bankTransfer: 'Pulsiz hisob-kitob',
                rightsReserved: 'Barcha huquqlar himoyalangan.', developedWithLove: '❤️ bilan ishlab chiqilgan',
                russian: 'Rus', english: 'Ingliz', uzbek: 'O\'zbekcha',
                ruble: 'Rubl', dollar: 'Dollar', sum: "So'm",
                purchaseOrders: 'Xarid buyurtmalari', all: 'Barchasi', today: 'Bugun', last3days: 'Oxirgi 3 kun', lastMonth: 'Oxirgi oy', product: 'Mahsulot', date: 'Sana',
                searchPlaceholder: 'Nomi bo\'yicha qidirish...', category: 'Kategoriya', games: 'O\'yinlar', apps: 'Ilovalar', sortBy: 'Saralash', newSort: 'Yangi', popularSort: 'Ommabop', productsNotFound: 'Mahsulotlar topilmadi',
                pinProduct: 'Mahsulotni mahkamlash', pinned: 'Mahkamlangan', loading: 'Yuklanmoqda...',
                uploadFile: 'Yuklash', noApiKey: 'ImgBB uchun API kaliti o\'rnatilmagan!', imageUploaded: 'Rasm muvaffaqiyatli yuklandi!',
                linkCopied: 'Havola nusxalandi!', confirmDeleteOrder: 'Haqiqatan ham ushbu buyurtmani o\'chirib tashlamoqchimisiz?', orderDeleted: 'Buyurtma o\'chirildi.',
                manageProducts: 'Mahsulotlarni boshqarish', backToPanel: 'Panelga qaytish', uploadAvatar: 'Avatar yuklash',
                chatWithAdmin: 'Ma\'muriyat bilan suhbat', chatWith: 'Suhbat', supportSubtitle: 'Agar savollaringiz bo\'lsa, suhbatni boshlash uchun quyidagi tugmani bosing.',
                darkTheme: 'Qorong\'u', lightTheme: 'Yorug\'', asonikTheme: 'Asonik', setColorAvatar: 'Rangli avatar',
                manageFaq: 'FAQ Boshqaruvi', question: 'Savol', answer: 'Javob', addFaq: 'FAQ qo\'shish', updateFaq: 'FAQ yangilash'
            }
        };

        const currencyRates = { RUB: 1, USD: 0.011, UZS: 140 };
        const currencySymbols = { RUB: '₽', USD: '$', UZS: "so'm" };

        const convertPrice = (priceInRub, targetCurrency) => {
            const rate = currencyRates[targetCurrency];
            const symbol = currencySymbols[targetCurrency];
            if (!rate || !priceInRub) return `0 ${symbol}`;
            const convertedPrice = priceInRub * rate;
            return `${convertedPrice.toLocaleString('ru-RU', { maximumFractionDigits: 2 })} ${symbol}`;
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
